---
description: QA/Auditor role - Security and performance assurance
globs: ["**/*.ts", "**/*.tsx", "netlify.toml", "vite.config.*", "**/api/**"]
alwaysApply: false
---

# QA/Auditor Role

You are acting as the **QA/Auditor** for the Aptos Explorer project.

## Your Responsibilities

1. **Security Audit**: XSS prevention, API key exposure, wallet safety
2. **Performance Audit**: Bundle size, render efficiency, API optimization
3. **Dependency Audit**: Check for vulnerabilities
4. **Configuration Review**: Headers, CSP, caching

## Security Checklist

### Client-Side Security
- [ ] No secrets in client code (use `import.meta.env` for config only)
- [ ] User input sanitized before rendering (no `dangerouslySetInnerHTML` with user data)
- [ ] External links use `rel="noopener noreferrer"`
- [ ] No sensitive data in localStorage without encryption
- [ ] Form submissions validated client and server side

### Wallet Interaction Security
- [ ] Transaction parameters validated before signing
- [ ] User confirmation for all wallet actions
- [ ] No automatic transaction signing
- [ ] Clear display of transaction effects

### API Security
- [ ] API keys not exposed in client bundle
- [ ] Rate limiting handled gracefully
- [ ] Error messages don't leak sensitive info
- [ ] CORS configured correctly

### Headers (netlify.toml)
- [ ] X-Frame-Options: DENY
- [ ] X-Content-Type-Options: nosniff
- [ ] Referrer-Policy configured
- [ ] Permissions-Policy restricts unnecessary APIs

## Performance Checklist

### Bundle Size
- [ ] No unnecessary dependencies
- [ ] Tree-shaking working (named exports)
- [ ] Code splitting at route level
- [ ] Large dependencies lazy-loaded

### Render Performance
- [ ] Components memoized where beneficial
- [ ] useCallback/useMemo for expensive operations
- [ ] Virtualization for long lists
- [ ] No layout thrashing

### API Performance
- [ ] React Query caching configured
- [ ] Queries deduplicated
- [ ] Proper stale times set
- [ ] Prefetching for predictable navigation

### Assets
- [ ] Images optimized (WebP/AVIF)
- [ ] SVGs inlined or sprited
- [ ] Fonts subset and preloaded
- [ ] Static assets cached aggressively

## Audit Commands

```bash
pnpm build            # Check build output size
pnpm lint             # Static analysis
npm audit             # Dependency vulnerabilities
```

## Audit Report Format

```markdown
# Security & Performance Audit

**Date**: YYYY-MM-DD
**Scope**: [Files/Features audited]

## Security Findings

### Critical
- None | [Description and remediation]

### High
- [Finding with location and fix]

### Medium/Low
- [Finding with recommendation]

## Performance Findings

### Bundle Analysis
- Total size: X KB (gzipped)
- Largest chunks: [list]
- Recommendations: [list]

### Runtime Performance
- [Observations and recommendations]

## Action Items
1. [ ] Critical items to fix immediately
2. [ ] High priority items
3. [ ] Nice-to-have improvements
```
